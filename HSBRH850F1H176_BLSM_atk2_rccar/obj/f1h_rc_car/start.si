#line 1 "../../arch/v850_gcc/start.S"











































 



 







#line 1 "../../arch/v850_ghs/v850asm.inc"



















































 



 




#line 1 "../../kernel/kernel_impl.h"

























































 










 






 
#line 1 "../../include/Os.h"























































 













 






 
#line 1 "../../include/Std_Types.h"























































 













 




#line 1 "../../arch/v850_gcc/Platform_Types.h"



















































 



 






 




















 






 




 
#line 127

#line 76 "../../include/Std_Types.h"
#line 1 "../../arch/ghs/Compiler.h"



















































 



 




#line 1 "../../arch/ghs/Compiler_Cfg.h"



















































 






 






 




#line 62 "../../arch/ghs/Compiler.h"























 

















#line 77 "../../include/Std_Types.h"



 
















 





















#line 79 "../../include/Os.h"
#line 1 "../../include/MemMap.h"























































 





#line 80 "../../include/Os.h"
#line 1 "../../include/Rte_Os_Type.h"























































 











#line 81 "../../include/Os.h"







 
#line 1 "../../target/rh850f1h_pb_gcc/target_kernel.h"



















































 






 




#line 1 "../../target/rh850f1h_pb_gcc/rh850f1h_pb.h"











































 


 




#line 1 "../../arch/v850_gcc/rh850_f1h.h"











































 



 












 




 
#line 91



 
#line 119



 
#line 147



 


 










 







#line 211




 






















 
 






 




 


























 






 











 









 











 







 












 
























 








#line 390


#line 1 "../../arch/v850_gcc/v850.h"



















































 



 






#line 102













#line 393 "../../arch/v850_gcc/rh850_f1h.h"

#line 53 "../../target/rh850f1h_pb_gcc/rh850f1h_pb.h"



 




 











 








 












 








#line 65 "../../target/rh850f1h_pb_gcc/target_kernel.h"



 



 


 


 


 





 




 
#line 1 "../../arch/v850_gcc/prc_kernel.h"



















































 






 




#line 88



 



#line 94 "../../target/rh850f1h_pb_gcc/target_kernel.h"

#line 90 "../../include/Os.h"

#line 378







 
#line 422

 






 








 










 










 




 








 
#line 501













#line 539



 







 
#line 661



 





 









 





 










#line 79 "../../kernel/kernel_impl.h"



 




 






 





 


#line 127



 






















 





 
#line 1 "../../kernel/ccb.h"























































 



 



#line 1 "../../target/rh850f1h_pb_gcc/target_ccb.h"



















































 



 





 




 




 




 




 
#line 1 "../../arch/v850_gcc/prc_ccb.h"



















































 



 



#line 1 "../../arch/v850_ghs/prc_insn.h"



















































 



 



#line 240

#line 62 "../../arch/v850_gcc/prc_ccb.h"

#line 84 "../../target/rh850f1h_pb_gcc/target_ccb.h"

#line 65 "../../kernel/ccb.h"

#line 251

#line 161 "../../kernel/kernel_impl.h"



 
#line 1 "../../target/rh850f1h_pb_gcc/target_config.h"



















































 






 




#line 1 "../../target/rh850f1h_pb_gcc/target_ici.h"



















































 



 






 




 










 

















 
#line 1 "../../arch/v850_gcc/prc_ici.h"











































 



 




#line 1 "../../arch/v850_gcc/prc_sil.h"



















































 



 












 


#line 253

#line 54 "../../arch/v850_gcc/prc_ici.h"

#line 93

#line 99 "../../target/rh850f1h_pb_gcc/target_ici.h"

#line 65 "../../target/rh850f1h_pb_gcc/target_config.h"



 




#line 99



 
#line 1 "../../arch/v850_gcc/prc_config.h"



















































 







 




#line 1 "../../arch/v850_gcc/prc_sil.h"



















































 



 


#line 66 "../../arch/v850_gcc/prc_config.h"



 





















 




 






#line 663

#line 104 "../../target/rh850f1h_pb_gcc/target_config.h"

#line 166 "../../kernel/kernel_impl.h"



 
#line 1 "../../kernel/allfunc.h"























































 



 




 








 






 








 






 




 










 












 




 




 












 









 








 







 
#line 193

 







 










#line 172 "../../kernel/kernel_impl.h"




 





 













 








#line 227



 






 
#line 280



 




 





 




 
#line 419

#line 62 "../../arch/v850_ghs/v850asm.inc"



 


	

 

	.macro	Lea name, destination
	mov	name, destination
	.endm

	



 
	.macro	Flabel name
	.type	name,@function
name:
	.endm



	

 
	
	.macro	Push source
	add	-4, sp
	st.w	source, 0[sp]
	.endm
	
	

 
	
	.macro	Pop dest
	ld.w	0[sp],dest
	add	4, sp
	.endm

	

 
	.macro	X_LOCK_ALL_INT reg1 reg2
	ld.w	PMR, reg1
	ld.w	0xffff, reg2
	and		reg2,reg1
	st.w	reg2
	.endm



 
.macro LOCK_ALL_INT
    di
.endm



 
.macro UNLOCK_ALL_INT
    ei
.endm



 
.macro GET_PEID reg
	stsr 0, reg, 2
	sar  16, reg
.endm



 
.macro GET_CID reg
	GET_PEID reg
	add -1, reg
.endm
#line 57 "../../arch/v850_gcc/start.S"


	.section .text
	.align  4
	.global __start
__start:
	di                                   

	

 
	GET_CID r4
	shl     2, r4
	Lea     __ostkpt_table, r3
	add     r3, r4
	ld.w    0[r4], r3
	Lea     __tp, tp
	Lea     __ep, ep
	Lea     __gp, gp
	Lea     __ctbp, r6
	ldsr    r6, 20


	

 
	stsr psw, r12        
	mov  0x00010000,r13  
	or   r13, r12
	ldsr r12, psw        


	 
	mov 0xfffee600, r20 -- PEG #0 base
	mov 0x0001, r21 -- PEGG1SP val / All SPID is permit
	mov 0xffffffff, r22 -- PEGG1MK val / All Address Masked
	mov 0x00000077, r23 -- PEGG1BA val / Enable, Read/Write permit, Non-Lock, Base=0

	st.h    r21, 0x0c[r20]   -- set PEGGSP
	st.w    r22, 0x80[r20]   -- set PEGG1MK
	st.w    r23, 0x84[r20]   -- set PEGG1BA

	-- Store completion barrier
	ld.w    0x84[r20], r0
	syncp

	




 
	Lea     hardware_init_hook, r1
	cmp     r0, r1
	be      hardware_init_hook_end
	jarl    [r1], lp
hardware_init_hook_end:

__start_1:
	

 

	

 
	GET_CID r6
	cmp     r0, r6
	bne     slave_start

	


 
	Lea     __bss_start, ep
	Lea     __bss_end, r7
bss_clear_start:
	cmp     ep, r7
	bl      bss_clear_end
	sst.w   r0, 0[ep]
	add     4, ep
	br      bss_clear_start
bss_clear_end:

	

 
	Lea     _core_state_table, r6
	st.w    r0, 4[r6]    

	

 
	mov     (0x87654321), r7
	st.w    r7, 0[r6]


	




 
	Lea     __idata_start, r6
	Lea     __idata_end,   r7
	Lea     __data_start,  r8
data_init_start:
	cmp     r6, r7
	bl      data_init_end
	ld.w    0[r6], r9
	st.w    r9, 0[r8]
	add     4, r6
	add     4, r8
	br      data_init_start
data_init_end:

	





 
	Lea     software_init_hook, r1
	cmp     r0, r1
	be      software_init_hook_end
	jarl    [r1], lp

software_init_hook_end:

__start_4:
	jarl    _target_hardware_initialize, r31

	

 
	mov  0xfffeec00, r20
	mov  (0x87654321), r7
	st.w r7, 0x00[r20]

__start_5:
	jarl    _main, r31
	halt

	

 
slave_start:
	

 
	mov  0xfffeec00, r20
	ld.w 0x00[r20], r6
	cmp  r0, r6
	be   slave_start

	

 
	GET_CID r6
	Lea     _core_state_table, r9
	shl     2, r6
	add     r6, r9
	mov     (0x87654321), r7
slave_start_1:
	ld.w    0[r9], r8
	cmp     r7, r8
	bne     slave_start_1
	br      __start_5

	.end
